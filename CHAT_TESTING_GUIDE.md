# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —á–∞—Ç–∞ StepUp Shoes

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0 (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

---

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (FIXED):

1. **‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞**
   - –î–æ–±–∞–≤–ª–µ–Ω optimistic UI - —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞

2. **‚úÖ Realtime –ø–æ–¥–ø–∏—Å–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
   - Skip —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—É–∂–µ –ø–æ–∫–∞–∑–∞–Ω—ã —á–µ—Ä–µ–∑ optimistic UI)
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

3. **‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π (nickname, –∏–º—è, —Ñ–∞–º–∏–ª–∏—è, –∞–≤–∞—Ç–∞—Ä)
   - –î–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

4. **‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π (–º–∞–∫—Å. 1920px, WebP)
   - Progress bar –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞ —Ä–∞–∑ (–º–∞–∫—Å. 10MB –∫–∞–∂–¥–æ–µ)

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Supabase Storage Bucket

**–í–ê–ñ–ù–û:** Bucket `chat-attachments` –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ Supabase Storage.

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Supabase Dashboard: Storage -> Buckets
-- –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ SQL Editor:
SELECT * FROM storage.buckets WHERE id = 'chat-attachments';
```

–ï—Å–ª–∏ bucket –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
# –ú–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –µ—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ:
# supabase/migrations/20251111120000_chat_storage.sql
```

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é:
- Storage -> New bucket
- Name: `chat-attachments`
- Public: **Yes**
- File size limit: 10 MB
- Allowed MIME types: image/*

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm ci
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–§–∞–π–ª `.env` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here
```

### 4. –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞

```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173

---

## üß™ –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

**–®–∞–≥–∏:**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ 2 –±—Ä–∞—É–∑–µ—Ä–∞/–≤–∫–ª–∞–¥–∫–∏** (–¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
   - –ë—Ä–∞—É–∑–µ—Ä A: Chrome (–æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º)
   - –ë—Ä–∞—É–∑–µ—Ä B: Chrome (–∏–Ω–∫–æ–≥–Ω–∏—Ç–æ) –∏–ª–∏ Firefox

2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A: user1@test.com
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B: user2@test.com

3. **–ù–∞–∑–Ω–∞—á—å—Ç–µ nicknames (–≤ Account):**
   - User A: @alice
   - User B: @bob

4. **User A: –°–æ–∑–¥–∞—Ç—å —á–∞—Ç:**
   - –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/chat`
   - –ù–∞–∂–∞—Ç—å "–ù–æ–≤—ã–π —á–∞—Ç"
   - –ü–æ–∏—Å–∫ –ø–æ `@bob`
   - –í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å"

5. **User A: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:**
   ```
   –ü—Ä–∏–≤–µ—Ç, Bob!
   ```
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤ UI (optimistic UI)
   - ‚úÖ –ü–æ—Å–ª–µ ~500ms —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ (—Å ID –æ—Ç –ë–î)
   - ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

6. **User B: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ:**
   - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `/chat`
   - ‚úÖ –ù–æ–≤—ã–π —á–∞—Ç —Å User A –≤–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ
   - ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ü—Ä–∏–≤–µ—Ç, Bob!"
   - ‚úÖ Unread badge —Å —Ü–∏—Ñ—Ä–æ–π 1

7. **User B: –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å:**
   - –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —á–∞—Ç
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å: `–ü—Ä–∏–≤–µ—Ç, Alice!`
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ User A –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (realtime)
   - ‚úÖ –ù–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - ‚úÖ –ó–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (optional)

---

### –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–®–∞–≥–∏:**

1. **User A: –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
   - –ù–∞–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É —Å–∫—Ä–µ–ø–∫–∏ üìé
   - –í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (JPG/PNG, –º–∞–∫—Å. 10MB)
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞
   - ‚úÖ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

2. **User A: –û—Ç–ø—Ä–∞–≤–∏—Ç—å:**
   - –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ Progress bar –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É (0-100%)
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - ‚úÖ –ö–ª–∏–∫ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–µ (–µ—Å–ª–∏ lightbox —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)

3. **User B: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ:**
   - ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–Ω–æ –≤ —á–∞—Ç–µ
   - ‚úÖ –ú–æ–∂–µ—Ç –∫–ª–∏–∫–Ω—É—Ç—å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å

4. **User A: –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
   - –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ä–∞–∑—É
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –í—Å–µ 3 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
   - ‚úÖ Progress bar –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
   - ‚úÖ –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏

---

### –¢–µ—Å—Ç 3: –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –∏ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

**–®–∞–≥–∏:**

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - User C: user3@test.com, @charlie

2. **User A: –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É:**
   - `/chat` -> –ù–æ–≤—ã–π —á–∞—Ç
   - –í—ã–±—Ä–∞—Ç—å "–ì—Ä—É–ø–ø–∞"
   - –ù–∞–∑–≤–∞–Ω–∏–µ: "–î—Ä—É–∑—å—è"
   - –î–æ–±–∞–≤–∏—Ç—å: @bob, @charlie
   - –°–æ–∑–¥–∞—Ç—å

3. **User A: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É:**
   ```
   –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!
   ```
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ User B –∏ User C –≤–∏–¥—è—Ç –≥—Ä—É–ø–ø—É –≤ —Å–ø–∏—Å–∫–µ
   - ‚úÖ –û–±–∞ –≤–∏–¥—è—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç!"

4. **User B –∏ User C: –û—Ç–≤–µ—Ç–∏—Ç—å:**
   - User B: `–ü—Ä–∏–≤–µ—Ç!`
   - User C: `–ò –º–Ω–µ –ø—Ä–∏–≤–µ—Ç!`
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –í—Å–µ —Ç—Ä–æ–µ –≤–∏–¥—è—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ realtime
   - ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤

---

### –¢–µ—Å—Ç 4: –û–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å presence tracking

**–®–∞–≥–∏:**

1. **User A: –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–û–Ω–ª–∞–π–Ω":**
   - `/chat` -> –≤–∫–ª–∞–¥–∫–∞ "–û–Ω–ª–∞–π–Ω"
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –í–∏–¥–Ω—ã User B –∏ User C (–µ—Å–ª–∏ –æ–Ω–∏ –æ–Ω–ª–∞–π–Ω)
   - ‚úÖ –ó–µ–ª–µ–Ω–∞—è —Ç–æ—á–∫–∞ —Ä—è–¥–æ–º —Å –∞–≤–∞—Ç–∞—Ä–æ–º
   - ‚úÖ Nickname –∏–ª–∏ –∏–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

2. **User B: –ó–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É:**
   - –ó–∞–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä
   - –ü–æ–¥–æ–∂–¥–∞—Ç—å 30-60 —Å–µ–∫—É–Ω–¥

3. **User A: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫:**
   - ‚úÖ User B –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –æ–Ω–ª–∞–π–Ω
   - ‚úÖ –ò–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ offline —Å last_seen

4. **User A: –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ User C
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä—è–º–æ–π —á–∞—Ç —Å User C
   - ‚úÖ –ò–ª–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π, –µ—Å–ª–∏ –µ—â–µ –Ω–µ –±—ã–ª–æ

---

### –¢–µ—Å—Ç 5: Read receipts (optional)

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–º–µ—Ç–∫–∏ "–ø—Ä–æ—á–∏—Ç–∞–Ω–æ"

**–®–∞–≥–∏:**

1. **User A: –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ User B:**
   ```
   –¢—ã –≤–∏–¥–µ–ª –Ω–æ–≤–æ—Å—Ç–∏?
   ```

2. **User B: –ù–ï –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —á–∞—Ç:**
   - –û—Å—Ç–∞—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ User A –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ" (–æ–¥–Ω–∞ –≥–∞–ª–æ—á–∫–∞)

3. **User B: –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç:**
   - –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —á–∞—Ç —Å User A
   
   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ User A –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ "–ø—Ä–æ—á–∏—Ç–∞–Ω–æ" (–¥–≤–µ –≥–∞–ª–æ—á–∫–∏ –∏–ª–∏ –¥—Ä—É–≥–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)

---

### –¢–µ—Å—Ç 6: Typing indicator (if implemented)

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞

**–®–∞–≥–∏:**

1. **User A: –ù–∞—á–∞—Ç—å –ø–µ—á–∞—Ç–∞—Ç—å:**
   - –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å User B
   - –ù–∞—á–∞—Ç—å –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å)

2. **User B: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   - ‚úÖ –í–∏–¥–∏—Ç "User A –ø–µ—á–∞—Ç–∞–µ—Ç..." –ø–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º —á–∞—Ç–∞

3. **User A: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—á–∞—Ç—å:**
   - –°—Ç–µ—Ä–µ—Ç—å —Ç–µ–∫—Å—Ç –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

4. **User B: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   - ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏—Å—á–µ–∑–∞–µ—Ç

---

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ù–∞–∂–∏–º–∞—é "–û—Ç–ø—Ä–∞–≤–∏—Ç—å", –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- –ò–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ —Å—Ä–∞–∑—É –∏—Å—á–µ–∑–∞–µ—Ç

**–†–µ—à–µ–Ω–∏—è:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12):**
   ```javascript
   // –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:
   // "–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: new row violates row-level security policy"
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS policies –≤ Supabase:**
   ```sql
   -- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ policies —Å—É—â–µ—Å—Ç–≤—É—é—Ç:
   SELECT * FROM pg_policies 
   WHERE tablename = 'messages';
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —á–∞—Ç–∞:**
   ```sql
   SELECT * FROM chat_members 
   WHERE chat_id = '<chat_id>' 
   AND user_id = '<user_id>';
   ```

4. **–ï—Å–ª–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–µ—Ç, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ:**
   ```sql
   -- –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ–≤—Ç–æ—Ä–Ω–æ
   -- supabase/migrations/20251105122231_...sql
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- Progress bar –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –Ω–∞ 0%
- –û—à–∏–±–∫–∞ "Bucket not found"

**–†–µ—à–µ–Ω–∏—è:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å bucket:**
   ```bash
   # –í Supabase Dashboard: Storage -> Buckets
   # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å: chat-attachments (public)
   ```

2. **–°–æ–∑–¥–∞—Ç—å bucket –≤—Ä—É—á–Ω—É—é:**
   - Storage -> New bucket
   - Name: `chat-attachments`
   - Public: Yes

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS policies –¥–ª—è storage:**
   ```sql
   -- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å policies –≤ –º–∏–≥—Ä–∞—Ü–∏–∏:
   -- 20251111120000_chat_storage.sql
   ```

4. **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:**
   - –ú–∞–∫—Å–∏–º—É–º 10MB
   - –ï—Å–ª–∏ –±–æ–ª—å—à–µ, —Å–∂–∞—Ç—å –∏–ª–∏ –æ–±—Ä–µ–∑–∞—Ç—å

---

### –ü—Ä–æ–±–ª–µ–º–∞: Realtime –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ realtime
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É

**–†–µ—à–µ–Ω–∏—è:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Realtime –≤ Supabase:**
   - Project Settings -> API -> Realtime
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Realtime **–≤–∫–ª—é—á–µ–Ω**

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –≤ –∫–æ–Ω—Å–æ–ª–∏:**
   ```javascript
   // –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:
   // "Subscribed to chat: <chat_id>"
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:**
   ```bash
   # –í Network tab (F12) -> WS
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ Supabase Realtime
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm run dev
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏–∫–∞—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã
- –ò–ª–∏ –º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —á—É–∂–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**–†–µ—à–µ–Ω–∏—è:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞:**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
   - –í `useChat.tsx` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã

2. **–û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞:**
   ```bash
   Ctrl + Shift + Delete -> –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É:**
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª
   - useEffect cleanup –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üìä Checklist –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä—è–º–æ–≥–æ —á–∞—Ç–∞ (1:1)
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ realtime
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã:
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã (3+ —É—á–∞—Å—Ç–Ω–∏–∫–∞)
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø—É
- [ ] –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≤–∏–¥—è—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è

### –û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å:
- [ ] –í–∫–ª–∞–¥–∫–∞ "–û–Ω–ª–∞–π–Ω" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] Online/offline –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —á–∞—Ç —Å –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### UI/UX:
- [ ] Optimistic UI —Ä–∞–±–æ—Ç–∞–µ—Ç (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
- [ ] Scroll –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–Ω–∏–∑ –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
- [ ] –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ö–Ω–æ–ø–∫–∏ –∏ –∏–∫–æ–Ω–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è toast –ø—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- [ ] –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
- [ ] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

---

## üîß –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ë–î:

```sql
-- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ
SELECT m.*, p.first_name, p.last_name 
FROM messages m
LEFT JOIN profiles p ON p.id = m.sender_id
WHERE m.chat_id = '<chat_id>'
ORDER BY m.created_at DESC
LIMIT 50;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞:

```sql
SELECT cm.*, p.first_name, p.last_name, p.nickname
FROM chat_members cm
JOIN profiles p ON p.id = cm.user_id
WHERE cm.chat_id = '<chat_id>';
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```sql
SELECT up.*, p.first_name, p.last_name, p.nickname
FROM user_presence up
JOIN profiles p ON p.id = up.user_id
WHERE up.status = 'online'
ORDER BY up.last_seen DESC;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å storage files:

```sql
SELECT * FROM storage.objects 
WHERE bucket_id = 'chat-attachments'
ORDER BY created_at DESC
LIMIT 20;
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞** (F12 -> Console)
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab** (F12 -> Network) –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase Logs** (Dashboard -> Logs -> Postgres)
4. **–°–æ–∑–¥–∞—Ç—å issue** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏

---

## ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ:

‚úÖ **–ß–∞—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω!**

–ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫:
- –î–æ–±–∞–≤–ª–µ–Ω–∏—é typing indicators
- –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ mentions (@username)
- Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- E2E —Ç–µ—Å—Ç–∞–º —Å Playwright/Cypress

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 11 –Ω–æ—è–±—Ä—è 2025  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 11 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0
