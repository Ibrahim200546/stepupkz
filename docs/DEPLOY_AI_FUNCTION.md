# üöÄ Deploy AI Chat Function —á–µ—Ä–µ–∑ Dashboard

**–°–ø–æ—Å–æ–± –¥–ª—è Windows** (CLI –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ npm)

---

## üìã –®–∞–≥ 1: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª:
```
C:\Users\user\stepupkz\supabase\functions\ai-chat\index.ts
```

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–ï–°–¨ –∫–æ–¥** (Ctrl+A, Ctrl+C)

---

## üåê –®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç—å Supabase Dashboard

```
https://supabase.com/dashboard/project/uoziiapuqunqbvevfzyu
```

–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

---

## ‚öôÔ∏è –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å Edge Function

1. **–°–ª–µ–≤–∞ –≤ –º–µ–Ω—é** ‚Üí **Edge Functions** (–∏–∫–æ–Ω–∫–∞ ‚ö°)

2. **–ù–∞–∂–∞—Ç—å:** "Create a new function" –∏–ª–∏ "+ New Function"

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:**
   - **Name:** `ai-chat` (—Ç–æ—á–Ω–æ —Ç–∞–∫!)
   - **Region:** –í—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π (Europe West –∏–ª–∏ US East)
   
4. **–í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∫–æ–¥–∞:**
   - –£–¥–∞–ª–∏—Ç—å –≤–µ—Å—å –∫–æ–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –í—Å—Ç–∞–≤–∏—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ (Ctrl+V)

5. **–ù–∞–∂–∞—Ç—å:** "Deploy" –∏–ª–∏ "Save"

---

## üîë –®–∞–≥ 4: –î–æ–±–∞–≤–∏—Ç—å API –∫–ª—é—á –≤ Secrets

1. **–í —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ Edge Functions**
2. **Settings** ‚Üí **Secrets** (–∏–ª–∏ "Manage secrets")
3. **Add new secret:**
   - **Key:** `OPENAI_API_KEY`
   - **Value:** `sk-proj-–≤–∞—à-–Ω–æ–≤—ã–π-openai-–∫–ª—é—á`
4. **Save**

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ù–û–í–´–ô –∫–ª—é—á (—Å—Ç–∞—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–æ–∑–≤–∞–Ω!)

---

## ‚úÖ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–í —Ä–∞–∑–¥–µ–ª–µ Edge Functions**
2. **–ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é** `ai-chat`
3. **–°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:** ‚úÖ Active
4. **URL –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ:** 
   ```
   https://uoziiapuqunqbvevfzyu.supabase.co/functions/v1/ai-chat
   ```

---

## üß™ –®–∞–≥ 6: –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Dashboard

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é** `ai-chat`
2. **Test** –∏–ª–∏ **Invoke**
3. **Body:**
   ```json
   {
     "message": "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",
     "conversationHistory": []
   }
   ```
4. **Send**

**–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:**
```json
{
  "message": "–ü—Ä–∏–≤–µ—Ç! üëã –Ø AI-–ø–æ–º–æ—â–Ω–∏–∫ StepUp Shoes...",
  "usage": {...}
}
```

---

## üéâ –®–∞–≥ 7: –¢–µ—Å—Ç –Ω–∞ —Å–∞–π—Ç–µ

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   npm run dev
   ```

2. **–û—Ç–∫—Ä—ã—Ç—å:** http://localhost:8081

3. **–°–ø—Ä–∞–≤–∞ –≤–Ω–∏–∑—É** –∫–Ω–æ–ø–∫–∞ ü§ñ

4. **–ù–∞–∂–∞—Ç—å** ‚Üí –Ω–∞–ø–∏—Å–∞—Ç—å "–ü—Ä–∏–≤–µ—Ç"

5. **AI –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å!** üéâ

---

## üêõ –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "AI-–ø–æ–º–æ—â–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –§—É–Ω–∫—Ü–∏—è –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞? (Edge Functions ‚Üí ai-chat ‚Üí Status: Active)
2. –°–µ–∫—Ä–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω? (Settings ‚Üí Secrets ‚Üí OPENAI_API_KEY)
3. –ö–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π? (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-proj-...`)

**–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:**
- Edge Functions ‚Üí ai-chat ‚Üí Logs
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –≤—ã–∑–æ–≤–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ 401 "Unauthorized"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π OpenAI API –∫–ª—é—á

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –Ω–∞ https://platform.openai.com/api-keys
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç –≤ Supabase

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∞ 429 "Rate limit"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ OpenAI

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 –º–∏–Ω—É—Ç—É

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–Ω–æ–ø–∫–∞ —á–∞—Ç–∞ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Delete)

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

### Supabase Logs:

```
Dashboard ‚Üí Edge Functions ‚Üí ai-chat ‚Üí Logs
```

–°–º–æ—Ç—Ä–∏—Ç–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤
- –û—à–∏–±–∫–∏
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### OpenAI Usage:

```
https://platform.openai.com/usage
```

–°–º–æ—Ç—Ä–∏—Ç–µ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
- –°—Ç–æ–∏–º–æ—Å—Ç—å
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å:

**–ú–æ–¥–µ–ª—å:** GPT-4o-mini

**–¶–µ–Ω—ã:**
- Input: $0.15 / 1M tokens
- Output: $0.60 / 1M tokens

**–ü—Ä–∏–º–µ—Ä–Ω–æ:**
- 1 —Å–æ–æ–±—â–µ–Ω–∏–µ = 500 tokens
- 1000 —Å–æ–æ–±—â–µ–Ω–∏–π ‚âà $0.50
- –û—á–µ–Ω—å –¥–µ—à–µ–≤–æ! üí∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

1. **API –∫–ª—é—á –ù–ï –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ**
   - –•—Ä–∞–Ω–∏—Ç—Å—è –≤ Supabase Secrets
   - –ó–∞—â–∏—â–µ–Ω –æ—Ç –∫—Ä–∞–∂–∏

2. **Edge Function –∫–∞–∫ proxy**
   - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Supabase
   - –ö–ª—é—á –Ω–µ –≤–∏–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

3. **Rate limiting**
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ Supabase
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

---

## ‚úÖ Checklist:

- [ ] –ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω
- [ ] Edge Function —Å–æ–∑–¥–∞–Ω–∞ –≤ Dashboard
- [ ] –ö–æ–¥ –≤—Å—Ç–∞–≤–ª–µ–Ω –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω
- [ ] OPENAI_API_KEY –¥–æ–±–∞–≤–ª–µ–Ω –≤ Secrets
- [ ] –§—É–Ω–∫—Ü–∏—è –≤ —Å—Ç–∞—Ç—É—Å–µ Active
- [ ] –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Dashboard –ø—Ä–æ—à–µ–ª
- [ ] Dev —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –ö–Ω–æ–ø–∫–∞ ü§ñ –≤–∏–¥–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- [ ] AI –æ—Ç–≤–µ—Ç–∏–ª —É—Å–ø–µ—à–Ω–æ

---

## üéØ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± (–±–µ–∑ Edge Function)

–ï—Å–ª–∏ Edge Function –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ OpenAI —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:

‚ö†Ô∏è **–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production** (API –∫–ª—é—á –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω)

```typescript
// –í AIChatWidget.tsx - –∑–∞–º–µ–Ω–∏—Ç–µ supabase.functions.invoke –Ω–∞:

const response = await fetch('https://api.openai.com/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${import.meta.env.VITE_OPENAI_API_KEY}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    model: 'gpt-4o-mini',
    messages: [
      { role: 'system', content: '–¢—ã AI-–ø–æ–º–æ—â–Ω–∏–∫ StepUp Shoes...' },
      { role: 'user', content: message }
    ],
    max_tokens: 500,
  }),
});

const data = await response.json();
const botMessage = data.choices[0].message.content;
```

–ù–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Edge Function! üõ°Ô∏è

---

**Dashboard URL:** https://supabase.com/dashboard/project/uoziiapuqunqbvevfzyu

**–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ AI –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç!** ü§ñ‚ú®
